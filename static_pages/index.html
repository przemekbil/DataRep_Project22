<!DOCTYPE html>
<html lang="eng">
    <head>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <title>Project for 2022 Data Representation course</title>
        <link rel="stylesheet" type="text/css" href="css/style.css"/>
    </head>
    <body>
        <h1>2022 DATA REPRESENTATION Project</h1>
        <h2>Select your profile</h2>
<!--         <form id="search_artist">
          <label for="query">Search:</label>
          <input type="text" id="query" name="query">
          <button type="submit">Search</button>
        </form> -->
        <div id="registered_users"></div>
        <script>
            function selectProfile(user_id){
                console.log(`Button Pressed: ${user_id}`);
            }
            function runOnLoad(){
                $.ajax(
                    {
                        "url":`/api/users`,
                        "method":"GET",
                        "data":"",
                        "dataType": "JSON",
                        "contentType": "application/json; charset=utf-8",
                        "success":function(result){
                            var UsersDisplayArea = document.getElementById("registered_users");
                                                                        
                            UsersDisplayArea.innerHTML='Registered profiles:';


                            for (const user of result){
                                var user_div = document.createElement('div');
                                user_div.setAttribute('class', 'user_div');
                                user_div.setAttribute('id', `div_uid${user.user_id}`);

                                var user_button = document.createElement('button');
                                user_button.innerHTML = user.name;
                                user_button.setAttribute('class', 'user_button');
                                user_button.setAttribute('id', `button_uid${user.user_id}`);
                                user_button.setAttribute('onclick', `selectProfile(${user.user_id})`);
                                
                                // Add new user div to User Display Area
                                user_div.appendChild(user_button);
                                UsersDisplayArea.appendChild(user_div);
                            }
                            var user_div = document.createElement('div');
                            user_div.setAttribute('class', 'user_div');
                            user_div.setAttribute('id', `div_uid0`);

                            var user_button = document.createElement('button');
                            user_button.innerHTML = "Add new Profile";
                            user_button.setAttribute('class', 'user_button');
                            user_button.setAttribute('id', `button_uid0`);
                            user_button.setAttribute('onclick', `selectProfile(0)`);
                                
                            // Add new user div to User Display Area
                            user_div.appendChild(user_button);
                            UsersDisplayArea.appendChild(user_div);                            

                        },
                        "error":function(xhr, status, error){
                            console.log("error: "+status+" msg: "+ error);
                        }
                    }
                )
            }
            window.addEventListener("load", runOnLoad);
        </script>        
    </body>
</html>